name: Keep Service Alive

on:
  schedule:
    # 每10分钟ping一次服务 (避免休眠)
    - cron: '*/10 * * * *'
  workflow_dispatch: # 允许手动触发

jobs:
  keep-alive:
    runs-on: ubuntu-latest
    
    steps:
    - name: Ping服务保持活跃
      run: |
        # 使用正确的Render服务地址
        SERVICE_URL="https://indonesia-map-feishu-integration.onrender.com"
        
        echo "正在ping服务: $SERVICE_URL"
        
        response=$(curl -s -o /dev/null -w "%{http_code}" "$SERVICE_URL")
        
        if [ $response -eq 200 ]; then
          echo "✅ 服务运行正常 (HTTP $response)"
        else
          echo "⚠️ 服务响应异常 (HTTP $response)"
          # 不要因为服务异常而失败，因为可能是服务正在启动
          echo "继续执行，可能服务正在启动中"
        fi
        
        echo "Keep-alive任务完成" 