🚨 飞书91402错误解决方案
======================================

问题诊断结果：
✅ 访问令牌获取成功 - 应用配置正确
❌ 多维表格应用访问失败 - App Token不正确

错误代码：91402 NOTEXIST
错误含义：指定的多维表格应用不存在或无权限访问

根本原因分析：
==============
当前使用的App Token：HEqVwhzBciH75KkD0ZclpFQugnJ
这个Token是从URL中提取的，但可能不是正确的多维表格App Token。

在飞书中，有两种不同的Token：
1. 云文档Token（从/wiki/链接中提取）
2. 多维表格App Token（实际需要的）

解决方案：
==========

方案1：获取正确的多维表格App Token
-----------------------------------
1. 打开您的飞书多维表格
2. 点击右上角的"..."或"设置"按钮
3. 选择"高级设置"或"应用设置"
4. 找到"App Token"或"应用令牌"
5. 复制这个Token（通常以"bascXXXXXX"开头）

方案2：通过开发者工具获取
-------------------------
1. 在浏览器中打开飞书多维表格
2. 按F12打开开发者工具
3. 切换到Network标签
4. 刷新页面
5. 查找包含"bitable"的请求
6. 在请求URL中查找app_token参数

方案3：从分享链接获取
---------------------
1. 在多维表格中点击"分享"按钮
2. 选择"公开链接"或"应用链接"
3. 从生成的链接中提取App Token
4. 正确的链接格式应该是：
   https://xxx.feishu.cn/base/[App_Token]?table=[Table_ID]

App Token格式说明：
==================
正确的App Token通常：
- 以"basc"开头（如：bascXXXXXXXXXXXXXXXX）
- 长度约为20-30个字符
- 只包含字母和数字

当前Token分析：
HEqVwhzBciH75KkD0ZclpFQugnJ
↑ 这个Token格式不符合标准的多维表格App Token格式

下一步操作：
============
1. 请按照上述方案获取正确的App Token
2. 将新的App Token替换配置文件中的值
3. 重新运行同步脚本

如果仍然遇到问题，可能的其他原因：
==============================
1. 应用权限不足：
   - 确保在飞书开发者后台配置了"bitable:record"权限
   - 确保应用已发布或在测试环境中正确配置

2. 多维表格权限：
   - 确保多维表格对您的应用开放了访问权限
   - 检查表格的分享设置

3. 应用范围：
   - 确认应用是否可以访问该组织/租户的数据

联系支持：
==========
如果以上方案都无法解决问题，请：
1. 检查飞书开发者文档的最新API变更
2. 联系飞书技术支持
3. 确认您的飞书版本和API版本兼容性

测试验证：
==========
获取新的App Token后，运行以下命令测试：
node 飞书API权限诊断脚本.js

如果看到"✅ 多维表格应用存在"，说明Token正确。 